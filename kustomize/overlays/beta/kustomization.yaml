apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
patches:
  - patch: |-
      - op: add
        path: "/spec/template/spec/containers/0/env/-"
        value:
          name: fint.operator.environment
          value: beta
      - op: add
        path: "/spec/template/spec/containers/0/env/-"
        value:
          name: flais.operators.ssoerator.test-environment
          value: "false"
      - op: add
        path: "/spec/template/spec/containers/0/env/-"
        value:
          name: flais.operators.ssoerator.middleware-image
          value: ghcr.io/fintlabs/flais-auth-forward-service:sha-ee1db52
    target:
      kind: Deployment
      name: ssoerator
  - patch: |-
      - op: replace
        path: "/spec/itemPath"
        value: "vaults/aks-beta-vault/items/ssoerator"
    target:
      kind: OnePasswordItem
      name: ssoerator